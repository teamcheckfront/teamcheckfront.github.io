jQuery('document').ready(function($){
   
    margin_left_product_thumbnail();
    jQuery(".variations_wrapper .__variations_wrapper_inner_column").each(function(){
        if($(this).find("div").length <=0 ){
            $(this).parent().addClass("__1column");
        }
    })
    
     jQuery(document).on("click",".lds-video-thumb",function(){
        if(jQuery(".lds-video-holder iframe").length<=0){
            var video_url = jQuery(this).attr("href");
            var iframe = '<iframe src="'+video_url+'" scrolling="no" style="width: 100%;overflow: hidden;border:none;" width="720" height="720px"></iframe>';
            setTimeout(function(){
                jQuery(".lds-video-holder").html(iframe);                
            },600)
        }
    })
    jQuery(document).on("click",".images div.thumbnails #bx-pager a",function(){
        var index = jQuery(this).attr("data-slide-index");
         setTimeout(function(){
            var _height = jQuery(".images div.thumbnails .bx-viewport").children("ul").children("li").eq(index).height();          
            jQuery(".images div.thumbnails .bx-viewport").height(_height);             
         },1000)
    })
    jQuery(".diamond-details-title > a").click(function(e){
        e.preventDefault();
        var section = jQuery(this).attr("href");
        jQuery('html, body').animate({
          scrollTop: jQuery(section).offset().top-180 
        }, 1000)
    })
    
    $(document).on("click",".thumbnails #bx-pager a",function(){
        var _parent = _j(this).parents(".thumbnails");
        _parent.find("#bx-pager a").removeClass("active");      
        var index = $(this).attr("data-slide-index");
        _parent.find("#bx-pager a").eq(index).addClass("active");
        $(".thumbnails ul li").each(function(_index){
             if($(this).find("video").size()>0){
                 if(index==_index){
                     $(this).find("video").get(0).play();
                 }else{
                     $(this).find("video").get(0).pause();
                 }
             }
         })
    })
    $(window).on("resize load",function(){
        
        setTimeout(function(){
            var width = $(".thumbnails ul li stream").width();
            $(".thumbnails ul li stream").height(width);
        },1000)
    })
    
    // lighbox video
    $(document).on("click","li.product h5 svg.preview-video",function(){
        var video = $(this).attr("data-video");
        var pid = $(this).attr("data-id");
        if (typeof video !== typeof undefined && video !== false) {
            if(video!==""){
                var _parent = $(this).parents(".product");
                if(_parent.find(".video-ligbox").length<=0){
                    var html = '<div class="hide"><div class="video-ligbox" id='+pid+'><stream width="720" height="720" style="width:720px;height:720px"  src="'+video+'" controls></stream><script type="text/javascript" src="https://embed.videodelivery.net/embed/r4xu.fla9.latest.js?video='+video+'"></script></div></div>';
                    _parent.append(html);                   
                }
                $.fancybox.open(jQuery("#"+pid),{
                    padding:0,
                    margin:0,
                    afterLoad:function(){
                      var _interval = setInterval(function(){
                          if(jQuery("#"+pid).find("video").length>0){                          
                            jQuery("#"+pid).find("video").get(0).play();
                            clearInterval(_interval);  
                          }
                      },1000)                          
                    },
                    beforeClose:function(){
                         if(jQuery("#"+pid).find("video").length>0){    
                            jQuery("#"+pid).find("video").get(0).pause();
                         }
                    }
                });  
            }
        }
        return false;
    });
    
});

function margin_left_product_thumbnail(){
   
    var _main = jQuery("body.single-product .main");
    jQuery(window).on("resize load",function(){
        if(_main.length>0){
            var bx_thumb = jQuery(".single-product .images .thumbnails #bx-pager");
            var _main_left = _main.offset().left;   

            if(_main_left<57){
                var _left = -_main_left;         
                bx_thumb.css({"margin-left":_left+"px"})
            }else{
                 bx_thumb.css({"margin-left":"-57px"})
            }
        }
    })
}