 jQuery(document).ready(function(){
    jQuery(document).bind('gform_page_loaded', function(){
       intAll()
    });
});
 jQuery(document).ready(function(){
     intAll()
 })
 function intAll(){
     intScrollbar ();
     radio_checked();
     radio_click ();
     set_current_page_form();
     make_active();
 }
function intScrollbar () {
   (function($){
       
		$(".gform_wrapper ul.gform_fields li.gfield.gf_list_5col .ginput_container").mCustomScrollbar({
                   /* scrollButtons:{enable:true},*/
					theme:"dark",
                    axis:"x",
                    scrollInertia: 0
				});
		})(jQuery);
}

function radio_checked(){
    jQuery(".gfield_radio li").each(function(){
        if(jQuery(this).find("input").is(":checked")){
            jQuery(this).addClass("checked-active");
        }else{
             jQuery(this).removeClass("checked-active");
        }
        if( jQuery(this).find(".input-radio").size()<=0){
             if( jQuery(this).find("img").size()>0){
            jQuery(this).find("input").wrap("<span class='input-radio'></span>")
             }
        }
    })   
    
     jQuery(".gfield_checkbox li").each(function(){
        if(jQuery(this).find("input").is(":checked")){
            jQuery(this).addClass("checked-active");
        }else{
             jQuery(this).removeClass("checked-active");
        }
        if( jQuery(this).find(".input-radio").size()<=0){
             if( jQuery(this).find("img").size()>0){
            jQuery(this).find("input").wrap("<span class='input-radio'></span>")
             }
        }
    })   
}
function radio_click (){
     jQuery(document).on("click",".gfield_radio li",function(){
        radio_checked();
         make_active();
    })
     jQuery(document).on("click",".gfield_checkbox li",function(){
        radio_checked();
         make_active();
    })
}

function set_current_page_form(){
    jQuery(".gform_wrapper").each(function(){
        var form = jQuery(this);
        var active = form.find(".gf_step").index(jQuery(".gf_step_active"));
        var count = form.find(".gf_step").size();         
        form.find(".gform_page").removeClass("current-page");
        form.find(".gform_page").eq(active).addClass("current-page");
        form.find(".gform_page").eq(active).addClass("active-page");
        form.find(".gform_page").eq(active).prevAll().addClass( "active-page" );
        
        if(count-1==active){
            // last page;
            jQuery(".gform_hiden_on_last").addClass("hide-on-last");
            form.find(".gform_page").removeClass("last-page-active");
            form.find(".gform_page").eq(active).addClass("last-page-active");
        }else{
             jQuery(".gform_hiden_on_last").removeClass("hide-on-last");
             form.find(".gform_page").removeClass("last-page-active");
        }      
                
    })
}
function make_active(){
    var html = "";
    var _html_results = "";
    var admin_url = SiteUrl+"/wp-admin/admin-ajax.php";
    var ajax_url ="";
    jQuery(".gform_page.active-page").each(function(){
        var __t = jQuery(this);
        __t.find(".gfield_radio").each(function(){
            var _t = jQuery(this);
             var _url_key = "";
                var _url_value = "";
            if(_t.find(".checked-active").size()>0){
                var label = _t.closest(".gfield").children(".gfield_label").text().replace("*","");
                var value = _t.find(".checked-active input").val();
                var _h = "<div><span class='label'>"+label+"</span><span class='value'>"+value+"</span></div>";
                if(jQuery(_h).find("img").size()>0){
                    
                }else{
                    html+=_h;
                    _url_key = jQuery(_h).find(".field-name").text();
                    _url_value +=","+value;
                }
                admin_url = updateQueryStringParameter(admin_url, _url_key, _url_value);
            }
        })
        
        __t.find(".gfield_checkbox").each(function(){
            var _t = jQuery(this);
            
            if(_t.find(".checked-active").size()>0){
                 var label = _t.closest(".gfield").children(".gfield_label").text().replace("*","");
                var _url_key = "";
                var _url_value = "";
                _t.find(".checked-active").each(function(){                    
                    var value = jQuery(this).find("input").val();
                    var _h = "<div><span class='label'>"+label+"</span><span class='value'>"+value+"</span></div>";  
                     if(jQuery(_h).find("img").size()>0){

                    }else{
                        html+=_h;
                        _url_key = jQuery(_h).find(".field-name").text();
                        _url_value +=","+value;
                    }
                })  
                admin_url = updateQueryStringParameter(admin_url, _url_key, _url_value);
            }
        })
       
    })
   
    if(html!=""){
        _html_results +="<div class='active-chose'><div class='vl'>"+html+"</div></div>";
    }
    var current_fields = jQuery(".gform_page.current-page .gform_fields");
    if(current_fields.children("li").eq(0).hasClass("gfield_html")){  
        
    }else{
        var li = "<li class='gfield gfield_html'></li>";
        current_fields.prepend(li);
    }
    if(current_fields.children("li").eq(0).find(".active-chose").size()<=0){
          current_fields.children("li").eq(0).append(_html_results); 
       }else{
           current_fields.children("li").eq(0).find(".active-chose").replaceWith(_html_results);
       }
   
}
function updateQueryStringParameter(uri, key, value) {
  var re = new RegExp("([?&])" + key + "=.*?(&|$)", "i");
  var separator = uri.indexOf('?') !== -1 ? "&" : "?";
  if (uri.match(re)) {
    return uri.replace(re, '$1' + key + "=" + value + '$2');
  }
  else {
    return uri + separator + key + "=" + value;
  }
}
